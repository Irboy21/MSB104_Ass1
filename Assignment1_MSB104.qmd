---
title: "Assignment 1"
format: html
editor: visual
---

## 

```{r}
library(modelr)
library(dplyr)
library(ggplot2)
library(tidyverse)
library(vtable)
library(flextable)
library(scales)
library(tinytex)
library(readxl)
library(stringr)
library(janitor)
```

```{r}
Sys.setlocale("LC_ALL", "Norwegian")
```

```{r}
library(readxl)
library(dplyr)
library(tidyr)
library(janitor)


# Henter inn populasjons datasett fra Excel
Populasjon <- read_excel("DEMO_Ass1.xlsx", sheet = 2, col_types = "text") %>%
  clean_names()

# Henter inn regional BNP datasett fra Excell 
BNP <- read_excel("GDP_Ass1.xlsx", sheet = 2, col_types = "text") %>%
  clean_names()


```

```{r}

# Omgjør populasjon til langt format 
PopulasjonLang <- Populasjon %>%
  pivot_longer(
    cols = starts_with("x"),
    names_to = "Aar",
    values_to = "Innbyggere"
  ) %>%
  mutate(
    Aar = as.integer(str_remove(Aar, "^x")),
    Innbyggere = as.numeric(str_replace_all(Innbyggere, " ", ""))
  )


```

```{r}

#Omgjør BNP til langt format

BNPLang <- BNP %>%
  pivot_longer(
    cols = starts_with("x"),
    names_to = "Aar",
    values_to = "BNP"
  ) %>%
  mutate(
    Aar = as.integer(str_remove(Aar, "^x")),
    BNP = as.numeric(str_replace_all(BNP, " ", ""))
  )
```

## Metadata BNP

Det finnes ulike hoved metoder å beregne brytto nasjonalt produkt på.
Eurostat har valgt å benytte den såkalte «inntekstmetoden».
Eurostat velger denne metoden ovenfor utgifts metoden grunnet mangel på data over gode overføringer mellom regioner.

Etter inntektsmetoden regnes BNP på følgende måte: Lønn som utbetales til ansatte + bedrifter sin fortjeneste + skatte og avgifter minus subsidier gitt fra staten + avskrivinger knyttet til industri.

```{r}
# Beregne BNP per innbygger(BNPPI) og ganger ut BNP som er oppgitt i millioner
BNPPI <- PopulasjonLang %>%
  left_join(BNPLang, by = join_by(region, Aar)) %>%
  mutate(
    Innbyggere = as.numeric(Innbyggere),
    BNP = as.numeric(BNP),
    BNPPI = (BNP * 1e6) / Innbyggere
  )

  
```

```{r}
BNPPI %>%
  summarise(across(everything(), ~ sum(is.na(.x))))
```

```{r}
#Fjerner alle regioner med NA verdier

BNPPIRen <- na.omit(BNPPI)

```

```{r}

# Grupper etter år

BNPPIRen %>%
  group_by(Aar) %>%  
  summarise(
    gjennomsnitt_BNP = mean(BNP, na.rm = TRUE),
    median_BNP = median(BNP, na.rm = TRUE),
    minste_BNP = min(BNP, na.rm = TRUE),
    største_BNP = max(BNP, na.rm = TRUE)
  ) %>%
  arrange(Aar)


```
