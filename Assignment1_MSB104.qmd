---
title: "Assignment 1 — MSB104 — Group 3"
author: "Irjan & Magnus"
format:
  html: default
  pdf: default
execute:
  echo: false
  warning: false
  message: false
---

```{r}
library(modelr)
library(dplyr)
library(ggplot2)
library(tidyverse)
library(vtable)
library(flextable)
library(scales)
library(tinytex)
library(readxl)
```

# Part A_ Sub-national GDP and GDP per capita
## Data aquisition

```{r, echo=TRUE}
Sys.setlocale("LC_ALL", "Norwegian")
```

```{r, echo=TRUE}
library(readxl)
library(dplyr)
library(tidyr)
library(janitor)


# Henter inn populasjons datasett fra excell
Populasjon <- read_excel("DEMO_Ass1.xlsx", sheet = 2, col_types = "text") %>%
  clean_names()

# Henter inn regional BNP datasett fra excell
BNP <- read_excel("GDP_Ass1.xlsx", sheet = 2, col_types = "text") %>%
  clean_names()

```

```{r, echo=TRUE}
# Omgjør BNP og populasjonen til langt format

PopulasjonLang <- Populasjon %>%
  pivot_longer(
    cols = starts_with("x"),
    names_to = "aar",
    values_to = "befolkning"
  ) %>%
  mutate(
    aar = as.integer(str_remove(aar, "^x")),
    befolkning = as.numeric(befolkning)
  )

BNPLang <- BNP %>%
  pivot_longer(
    cols = starts_with("x"),
    names_to = "aar",
    values_to = "BNP"
  ) %>%
  mutate(
    aar = as.integer(str_remove(aar, "^x")),
    BNP = as.numeric(BNP)
  )

```

### Kort gjennomgang av datasett og variabler

Datasette *demo_r_pjanggr3* som er hentet fra Eurostat inneholder årlige befolkningestimater på NUTS3-nivå for EU-, EFTA- og kandidatland. Variablene **values** viser totalt antall bosatte personer per 1. januar, målt i antall personer. Hver observasjon identifiseres ved regionkode(**geo**) og år (**time**), samnt kjønn (**sex**) og alder (**age**). I denne analysen benyttes kun total befolkning (**sex = T**,**age = TOTAL**), slik at dataene ikke er splittet etter kjønn eller alder.

## GDP per Capita Calculation

```{r}
Kombinert <- PopulasjonLang %>%
  left_join(BNPLang, by = join_by(region, aar)) %>%
  mutate(bnp_per_innbygger = (BNP * 1e6) / befolkning)

```


## Decriptive Analysis
```{r}
gdpc_summary <- combined_clean %>%
  summarise(
    gjennomsnitt = mean(gdp_per_capita),
    median = median(gdp_per_capita),
    standardavvik = sd(gdp_per_capita),
    minimum = min(gdp_per_capita),
    maksimum = max(gdp_per_capita)
  )

gdpc_summary
```

```{r}
combined_clean %>%
  group_by(time) %>%
  summarise(mean_gdpc = mean(gdp_per_capita, na.rm = TRUE)) %>%
  ggplot(aes(x = time, y = mean_gdpc)) +
  geom_line(color = "steelblue") +
  geom_point() +
  labs(
    title = "Utvikling i gjennomsnittlig BNP per innbygger (2000–2023)",
    x = "År",
    y = "Euro per person",
    caption = "Kilde: Eurostat – nama_10r_3gdp og demo_r_pjanaggr3"
  )

```










